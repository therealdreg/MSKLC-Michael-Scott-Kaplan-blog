<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/12/21/506427.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:40 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>New in Windows Vista: updates to clock and calendar</title></head><body>
<h1>New in Windows Vista: updates to clock and calendar</h1>
<p><em>by Michael S. Kaplan, published on 2005/12/21 11:01 -08:00, original URI: http://blogs.msdn.com/michkap/archive/2005/12/21/506427.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostOld -->
<P><FONT face=Tahoma>It was almost nine months ago since I pointed out that <A href="http://archives.miloush.net/michkap/archive/2005/03/28/402839.html" mce_href="http://archives.miloush.net/michkap/archive/2005/03/28/402839.html"><STRONG>The WinForms DateTimePicker and MonthCalendar do not support culture settings</STRONG></A>.</FONT></P>
<P><FONT face=Tahoma>And there was also the time I talked about <STRONG><A href="http://archives.miloush.net/michkap/archive/2005/12/02/498876.html" mce_href="http://archives.miloush.net/michkap/archive/2005/12/02/498876.html">Calendars in other languages</A></STRONG>.</FONT></P>
<P><FONT face=Tahoma>I tried to point out that WinForms was merely wrapping the Shell common controls, which do not support other calendars. So there is nothing to be done.</FONT></P>
<P><FONT face=Tahoma>More recently I posted about how <STRONG><A href="http://archives.miloush.net/michkap/archive/2005/09/01/459019.html" mce_href="http://archives.miloush.net/michkap/archive/2005/09/01/459019.html">The calendar applet limps along</A></STRONG>.</FONT></P>
<P><FONT face=Tahoma>I received 17 email responses to these two posts from various people on my team here in Redmond, in Ireland, and from the folks on the Shell team who wondered if I was aware of the efforts to support things a bit more effectively in Vista.</FONT></P>
<P><FONT face=Tahoma>I was! It is just that it was to early to talk about it yet. And the blog entry was about the problem someone was having <EM>back then</EM>.</FONT></P>
<P><FONT face=Tahoma>Now yesterday, Adam Nathan posted some screenshots from the December CTP on Windows Vista <A href="http://blogs.msdn.com/adam_nathan/archive/2005/12/20/505917.aspx" mce_href="http://blogs.msdn.com/adam_nathan/archive/2005/12/20/505917.aspx">here</A> and he included that little clock/calendar applet, so I thought it might make sense to show one of the exciting capabilities that is in the December CTP build. I suspect <A href="http://winsupersite.com/" mce_href="http://winsupersite.com/">Paul Thurrott</A> will be getting to them eventually, too (with the other five pages of screenshots and exhaustive reviews). :-)</FONT></P>
<P><FONT face=Tahoma><EM>If you have access to that build then you can play with the stuff below and enjoy yourself -- if no, perhaps Paul will be covering it in a future set of screenshots on the winsupersite. :-)</EM></FONT></P>
<P><FONT face=Tahoma>There is of course the standard new cool calendar and clock you get when you <STRIKE><FONT color=#a9a9a9>double</FONT></STRIKE>single-click on the time as Adam indicated:</FONT></P>
<P><FONT face=Tahoma color=#ff0000><EM>UPDATE 12:28pm -- As I just learned from John Murphy (one of those guys in Ireland!), you only need to SINGLE-click to get the flyout to fly out,&nbsp;not a double click....</EM></FONT></P>
<P><IMG src="http://trigeminal.fmsinc.com/images/VistaCal_English.jpg" mce_src="http://trigeminal.fmsinc.com/images/VistaCal_English.jpg"></P>
<P><FONT face=Tahoma>Now what happens if you change your default user locale to Arabic (Saudi Arabia)?</FONT></P>
<P><FONT face=Tahoma><IMG src="http://trigeminal.fmsinc.com/images/VistaCal_Arabic.jpg" mce_src="http://trigeminal.fmsinc.com/images/VistaCal_Arabic.jpg"></FONT></P>
<P><FONT face=Tahoma>Wow, it is supporting non-Gregorian calendars! And this is not a fluke, you can try changing to Thai, the Japanese Emporer calendar, or even the Hebrew calendar:</FONT></P>
<P><FONT face=Tahoma><IMG src="http://trigeminal.fmsinc.com/images/VistaCal_Thai.jpg" mce_src="http://trigeminal.fmsinc.com/images/VistaCal_Thai.jpg"> </FONT><FONT face=Tahoma><IMG src="http://trigeminal.fmsinc.com/images/VistaCal_Japanese.jpg" mce_src="http://trigeminal.fmsinc.com/images/VistaCal_Japanese.jpg"> </FONT><FONT face=Tahoma><IMG src="http://trigeminal.fmsinc.com/images/VistaCal_Hebrew.jpg" mce_src="http://trigeminal.fmsinc.com/images/VistaCal_Hebrew.jpg"></FONT></P>
<P><FONT face=Tahoma>And more!</FONT></P>
<P><FONT face=Tahoma>Clearly the problems described in <A href="http://archives.miloush.net/michkap/archive/2005/09/01/459019.html" mce_href="http://archives.miloush.net/michkap/archive/2005/09/01/459019.html"><STRONG>The calendar applet limps along</STRONG></A> have been fixed, and they were fixed by making use of the Shell controls, and of course making the Shell controls understand other calendars. In essence, t</FONT><FONT face=Tahoma>he MonthCal and DateTimePicker controls in the Windows Shell now can support&nbsp;many other calenders -- an awesome&nbsp;feature done with the cross-group work of our team (a little in Redmond <STRONG>and a <U>lot</U> in Ireland -- you folks rock!</STRONG>) and the Shell folks. A much cooler international story, all the way around. :-)</FONT></P>
<P><FONT face=Tahoma>Now does this mean the problems described in <A href="http://archives.miloush.net/michkap/archive/2005/03/28/402839.html" mce_href="http://archives.miloush.net/michkap/archive/2005/03/28/402839.html"><STRONG>The WinForms DateTimePicker and MonthCalendar do not support culture settings</STRONG></A> are fixed? Well, if you think about it, they may or may not be. Especially when you consider that the WinForms code was written before this feature even existed, it is unclear whether WinForms will be taking the appropriate steps as a control host to change the setting. Definitely something to try on your Vista machine! And something that I can cover later as well.</FONT></P>
<P><FONT face=Tahoma>There is obviously a lot more to this feature and what has been done with it and what can be done with it in Vista, that I will cover another time. There are even other features tucked away and waiting for the explanation in upcoming blog entries.</FONT></P>
<P><FONT face=Tahoma>I may even see if I can get someone (maybe a "guest blogger"?) to say a few words about what it was like to move some of the algorithms that were done in managed code back into the unmanaged world.</FONT></P>
<P><FONT face=Tahoma>But for now, I just wanted to make sure all the people looking at Adam's blog would not wonder whether Microsoft had fixed the "international thing" with that clock/calendar applet -- we did!</FONT></P>
<P><FONT face=Tahoma>In future posts I'll talk about the interactions with the managed controls, some of the other new features, and even more exciting Vista stuff.</FONT></P>
<P><FONT face=Tahoma>And if you have the December CTP build, then start playing with it -- many exciting new features are in there....</FONT></P>
<P><FONT face=Tahoma></FONT></P>
<P><FONT face=Tahoma><FONT color=#ff1493><EM>This post brought to you by</EM> "ฟ" <EM>(<A href="http://www.fileformat.info/info/unicode/char/0e1f" mce_href="http://www.fileformat.info/info/unicode/char/0e1f">U+0e1f</A>, THAI CHARACTER FO FAN)</EM></FONT></FONT></P>
<hr/><p><a id="506450" href="#506450">#</a> <strong>Maurits</strong> on Wednesday, December 21, 2005 2:20 PM:</p><div style="margin-left: 1em">Everything's localized but the numbers, eh?<br><br>Do Arabic users read numbers left-to-right?  Or, to look at it a different way, do they read numbers little-endian?</div>
<p><a id="506453" href="#506453">#</a> <strong>Michael S. Kaplan</strong> on Wednesday, December 21, 2005 2:28 PM:</p><div style="margin-left: 1em">Actually, digit substitution is an overridable setting that varies with the locale -- it is not really being localized so much as that setting, and RTL display is a localization option (and I am on an English system at the moment!).<br><br>I should probably get into some of those issues in future posts, though!</div>
<p><a id="506455" href="#506455">#</a> <strong>Mihai</strong> on Wednesday, December 21, 2005 2:31 PM:</p><div style="margin-left: 1em">Not sure if it is the same question with Maurits, but: do Arabic users have the days going left-to-right in calendars?<br><br>Shoud it be this? I have to check with some natives :-)<br> 7  6  5  4  3  2  1<br>14 13 12 11 10  9  8<br>21 20 19 18 17 16 15<br>28 27 26 25 24 23 22<br>31 30 29<br></div>
<p><a id="506458" href="#506458">#</a> <strong>Michael S. Kaplan</strong> on Wednesday, December 21, 2005 2:44 PM:</p><div style="margin-left: 1em">That is one of his questions, in fact. :-)</div>
<p><a id="506465" href="#506465">#</a> <strong>PatriotB</strong> on Wednesday, December 21, 2005 2:53 PM:</p><div style="margin-left: 1em">Wow.  Cool stuff!  Great to see the common controls getting updated.<br><br>I must admit, however, I am going to miss the old-school GDI clock that we've had for the past 10+ years.</div>
<p><a id="506493" href="#506493">#</a> <strong>Paul M</strong> on Wednesday, December 21, 2005 4:11 PM:</p><div style="margin-left: 1em">The left to right issue was the first thing I thought of when I saw the screencaps.  But, I don't see any examples of arabic calendars on the net... I think I'll change my search language...  Ah-ha:<br><br><a rel="nofollow" target="_new" href="http://www.maggime.com/arabic/maggicalender.asp">http://www.maggime.com/arabic/maggicalender.asp</a><br>vs.<br><a rel="nofollow" target="_new" href="http://www.maggime.com/english/maggicalender.asp?">http://www.maggime.com/english/maggicalender.asp?</a><br><br>They are both the (gregorian?) calendar, constraining the differences to the L2R/R2L issue.  I also see a lot of hybrid examples like this:<br><br><a rel="nofollow" target="_new" href="http://www.aacps.org/aacps/boe/schol/arab_cal.pdf">http://www.aacps.org/aacps/boe/schol/arab_cal.pdf</a><br><br>This issue also brings up the sticky issue of localizing/converting between entirely different calendar systems.  Just how far does the localization you requested need to go, anyway, Mr. User?<br><br>This could get *really* complicated.  Converting appointments between two calendar systems could be a nightmare.  I just learned in my googling that dates on the islamic calendar start, not at 'midnight', but at sunset the previous day.  How confusing.</div>
<p><a id="506496" href="#506496">#</a> <strong>Paul M</strong> on Wednesday, December 21, 2005 4:17 PM:</p><div style="margin-left: 1em">P.S.  Why did the control get so much wider under arabic?</div>
<p><a id="506503" href="#506503">#</a> <strong>Michael S. Kaplan</strong> on Wednesday, December 21, 2005 4:38 PM:</p><div style="margin-left: 1em">Everyone -- I did verify that when I changed the digit substitution from 'context' to 'national' that I got the Hindi digits rather then our Arabic-Indic ones.<br><br>Paul -- Yes, the calendar issue is an unusual one for Bidi -- and the line between the UI language vs. user locale gets very blurred there.<br><br>The width has to do with the width of the text on the control (which ends being based on font info more than anything else).</div>
<p><a id="506516" href="#506516">#</a> <strong>Maurits</strong> on Wednesday, December 21, 2005 5:04 PM:</p><div style="margin-left: 1em">&gt; dates on the islamic calendar start, not at 'midnight', but at sunset the previous day<br><br>Makes sense to me.  How do you know when &quot;midnight&quot; is?  Sunset is obvious.<br><br>What still blows my mind is that all cultures agree on a seven-day week, especially since there's no corresponding celestial cycle.</div>
<p><a id="506548" href="#506548">#</a> <strong>Michael S. Kaplan</strong> on Wednesday, December 21, 2005 6:50 PM:</p><div style="margin-left: 1em">Hi Maurits,<br><br>Well, there may be places that do not -- but none that are yet supported on Windows!</div>
<p><a id="506555" href="#506555">#</a> <strong>Matthew W. Jackson</strong> on Wednesday, December 21, 2005 7:21 PM:</p><div style="margin-left: 1em">Do you still get a clock and calendar if you single-click on the tray clock and you are not an Administrator?<br><br>Obviously you shouldn't be able to set the time, but I'm going to be seriously annoyed if I get a message box stating &quot;You do not have the proper privlege level to change the System Time&quot; every time I accidentally (or purposfully) click on the time.</div>
<p><a id="506558" href="#506558">#</a> <strong>Michael S. Kaplan</strong> on Wednesday, December 21, 2005 7:30 PM:</p><div style="margin-left: 1em">Hi Matthew --<br><br>In fact, you do get the flyout, you do not have to be an administrator -- the confusion regarding the old behavior was addressed with extreme prejudice (to borrow the terminology of another profession).</div>
<p><a id="506571" href="#506571">#</a> <strong>Maurits</strong> on Wednesday, December 21, 2005 8:18 PM:</p><div style="margin-left: 1em">Hmmm... I'm guessing you need administrative privileges to:<br><br>* Change the date or time<br>* Set, change, or delete the NTP server<br>* Change the SYSTEM time zone (if such a thing exists)<br>* Change the SYSTEM locale settings (if such a thing exists)<br><br>but anyone can:<br><br>* View the date and time<br>* Page through the calendar<br>* Change the user time zone<br>* Change the user locale settings<br>* Manually trigger an NTP update, if the server is set</div>
<p><a id="506573" href="#506573">#</a> <strong>Michael S. Kaplan</strong> on Wednesday, December 21, 2005 8:22 PM:</p><div style="margin-left: 1em">Well, there are not yet user time zones, but the rest looks about right. :-)</div>
<p><a id="506623" href="#506623">#</a> <strong>abhinaba</strong> on Thursday, December 22, 2005 12:50 AM:</p><div style="margin-left: 1em">Is there a list? I mean are the Indian calenders supported as well?</div>
<p><a id="506627" href="#506627">#</a> <strong>Michael S. Kaplan</strong> on Thursday, December 22, 2005 1:17 AM:</p><div style="margin-left: 1em">There are not any in Vista at the moment, sorry. Is there a particular calendar you were interested in?</div>
<p><a id="506632" href="#506632">#</a> <strong>Si</strong> on Thursday, December 22, 2005 1:36 AM:</p><div style="margin-left: 1em">Why did you turn ClearType off for these screen grabs? <br><br>Cheers, Si</div>
<p><a id="506719" href="#506719">#</a> <strong>Michael S. Kaplan</strong> on Thursday, December 22, 2005 9:29 AM:</p><div style="margin-left: 1em">Hello Si!<br><br>It was not intentional, I promise. :-)<br><br>But I grabbed them through a Terminal Services session from my XPSP2 machine to me Vista machine. Both have ClearType turned on, but apparently that was not good enough.... :-(</div>
<p><a id="506764" href="#506764">#</a> <strong>Maurits</strong> on Thursday, December 22, 2005 11:59 AM:</p><div style="margin-left: 1em">Whoa... different users of the same computer can't independently choose their own time zone?</div>
<p><a id="506790" href="#506790">#</a> <strong>Michael S. Kaplan</strong> on Thursday, December 22, 2005 12:46 PM:</p><div style="margin-left: 1em">You never noticed, Maurits?<br><br>Yes, I will be covering this in  future blog post. :-)</div>
<p><a id="506802" href="#506802">#</a> <strong>Si</strong> on Thursday, December 22, 2005 1:09 PM:</p><div style="margin-left: 1em">&gt; But I grabbed them through a Terminal Services session from my XPSP2 machine to me Vista machine. <br><br>That explains it, CT over TS is still a work in progress.<br><br>Cheers, Si</div>
<p><a id="507102" href="#507102">#</a> <strong>Maurits</strong> on Friday, December 23, 2005 1:49 PM:</p><div style="margin-left: 1em">What do Terminal Server clients do, then?  Just live with the server time zone?  Guess I'll wait for the post. :)<br><br>Ever toyed with the idea of localizing to fantasy locales like Tengwar/Hobbit/Klingon?  Hobbit has a seven-day week, but with &quot;leap days&quot; (that belong to no week...)</div>
<p><a id="507573" href="#507573">#</a> <strong>silverpie</strong> on Tuesday, December 27, 2005 2:34 PM:</p><div style="margin-left: 1em">Not to mention a historical calendar that had 10-day weeks and leap days outside the weeks (the French Revolutionary).</div>
<p><a id="507594" href="#507594">#</a> <strong>Crissov</strong> on Tuesday, December 27, 2005 3:42 PM:</p><div style="margin-left: 1em">I’d like to see the major (Gregorian) calendar reform proposals supported, e.g. Symmetry454, if that’s not too simple. After all it’s not impossible that one of them could get wider support.<br>For most of these you definitely need week numbers! Actually any serious and/or ISO-conform calendar would feature them. (I assume all European localisation start the week on Monday.)<br><br>Can /really/ traditionalistic Chinese or French revolutionists use their time/clock format in Vista?<br><br>And where are the indicators for the current time (and date) in the company/domain/server time zone or the one retrieved from GPS information (or similar), if available? ;)</div>
<p><a id="507608" href="#507608">#</a> <strong>Michael S. Kaplan</strong> on Tuesday, December 27, 2005 5:05 PM:</p><div style="margin-left: 1em">Hmmm.... well, Symmetry454 may be interesting but I would imagine there might have to be a bit more support behind it before it would magically pop up in Windows.</div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2011/12/30 <a href="http://archives.miloush.net/michkap/archive/2011/12/30/10251957.html">We call 'em ShortestDayNames for a reason; they're as short as they're EVER gonna be!</a></p><p>2010/03/31 <a href="http://archives.miloush.net/michkap/archive/2010/03/31/9986458.html">OS level support for non-Gregorian calendars?</a></p><p>2007/10/23 <a href="http://archives.miloush.net/michkap/archive/2007/10/23/5613124.html">Some thoughts on global development projects</a></p><p>2006/12/22 <a href="http://archives.miloush.net/michkap/archive/2006/12/22/1350684.html">Sometimes when sorting the index is the last thing you want to use</a></p><p>2006/11/19 <a href="http://archives.miloush.net/michkap/archive/2006/11/19/1103636.html">'Son, your TextBox is writing checks that your EDIT control can't cash'</a></p><p>2006/07/08 <a href="http://archives.miloush.net/michkap/archive/2006/07/08/659302.html">They could be a little shorter</a></p><p>2006/06/13 <a href="http://archives.miloush.net/michkap/archive/2006/06/13/629804.html">Size matters (when it comes to day names, at least)</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2005/12/22/506590.html" title="We can&#39;t win when it comes to those pesky standards, can we?">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2005/12/21/506248.html" title="BACKSPACE vs. DELETE">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-12">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2005-12-21">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2005/12/21/506427.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:40 GMT -->
</html>