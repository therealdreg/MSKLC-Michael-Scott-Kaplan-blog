<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/04/26/2286153.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:38 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>No Regex in the Unicode room! (and no sex in the champagne room, either!)</title></head><body>
<h1>No Regex in the Unicode room! (and no sex in the champagne room, either!)</h1>
<p><em>by Michael S. Kaplan, published on 2007/04/26 09:01 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2007/04/26/2286153.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P><EM>(apologies to Chris Rock for the title!)</EM></P>
<P>Ted first sent me mail years ago, he was asking some questions about MSLU and Julie (who knew Ted back from when he was working for Microsoft) sent him to me. If memory serves he actually pointed out an interesting bug or two&nbsp;in the course of answering those questions that I ended up fixing.... :-)</P>
<P>Anyway, a few years later he came back to Microsoft and from time to time a question would come up about some random Unicode or internationalization thing and I'd often know the answer. </P>
<P>Though the question that came up yesterday from his colleague Kevin, I did not know for sure what was going on. </P>
<P>The problem amounted to a Regex expression that should have returned the same results as <A href="http://msdn2.microsoft.com/library/system.char.isletter.aspx" mce_href="http://msdn2.microsoft.com/library/system.char.isletter.aspx">char.IsLetter</A>, but it wasn't. This code listed the characters with the problem:</P>
<BLOCKQUOTE><FONT face="Consolas,Lucida Console,Courier New,Courier" size=2><B>
<P>using System;<BR>using System.IO;<BR>using System.Text;<BR>using System.Globalization;<BR>using System.Text.RegularExpressions;<BR>namespace UnicodeCategory {<BR>&nbsp;&nbsp;&nbsp; class Program&nbsp;&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; static void Main(string[] args)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; StringBuilder sb = new StringBuilder();<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int cnt = 0;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; char c = char.MinValue;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; do {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; const RegexOptions opt = RegexOptions.Compiled<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | RegexOptions.CultureInvariant<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | RegexOptions.IgnoreCase<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | RegexOptions.ExplicitCapture;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Regex regex = new Regex(@"^([\p{Lu}\p{Ll}\p{Lt}\p{Lm}\p{Lo}]+)$", opt);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; bool regexOK = regex.Match(c.ToString()).Success;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; bool functionOK = Char.IsLetter(c);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (regexOK != functionOK) {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cnt++;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sb.AppendLine(string.Format("regex: {0}\tfunction: {1}\tchar in hex: {2:x} - {3}", <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; regexOK, functionOK, (int)c, CharUnicodeInfo.GetUnicodeCategory(c)));<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (c == char.MaxValue) {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; c++;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } while (true);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sb.AppendLine(string.Format("TOTAL mismatches: {0}", cnt));<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; File.WriteAllText("result.txt", sb.ToString());<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<BR>&nbsp;&nbsp;&nbsp; }<BR>}</P></B></FONT></BLOCKQUOTE>
<P>The code was finding a total of 213 characters that were detected by <A href="http://msdn2.microsoft.com/library/system.char.isletter.aspx" mce_href="http://msdn2.microsoft.com/library/system.char.isletter.aspx">char.IsLetter</A>&nbsp;that the Regex expression that was literally searching for the same Unicode categories was not finding. The full list of characters this code was returning was:</P>
<BLOCKQUOTE>
<P><FONT size=1>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 130 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 1a6 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 1c5 - TitlecaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 1c8 - TitlecaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 1cb - TitlecaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 1f2 - TitlecaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 1f6 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 1f7 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 1f8 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 218 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 21a - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 21c - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 21e - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 220 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 222 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 224 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 226 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 228 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 22a - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 22c - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 22e - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 230 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 232 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 23a - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 23b - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 23d - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 23e - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 241 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 3d2 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 3d3 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 3d4 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 3d8 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 3da - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 3dc - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 3de - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 3e0 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 3f4 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 3f7 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 3f9 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 3fa - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 3fd - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 3fe - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 3ff - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 400 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 40d - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 48a - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 48c - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 48e - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 4c0 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 4c5 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 4c9 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 4cd - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 4ec - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 4f6 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 500 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 502 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 504 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 506 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 508 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 50a - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 50c - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 50e - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 1f88 - TitlecaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 1f89 - TitlecaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 1f8a - TitlecaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 1f8b - TitlecaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 1f8c - TitlecaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 1f8d - TitlecaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 1f8e - TitlecaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 1f8f - TitlecaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 1f98 - TitlecaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 1f99 - TitlecaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 1f9a - TitlecaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 1f9b - TitlecaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 1f9c - TitlecaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 1f9d - TitlecaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 1f9e - TitlecaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 1f9f - TitlecaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 1fa8 - TitlecaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 1fa9 - TitlecaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 1faa - TitlecaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 1fab - TitlecaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 1fac - TitlecaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 1fad - TitlecaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 1fae - TitlecaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 1faf - TitlecaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 1fbc - TitlecaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 1fcc - TitlecaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 1ffc - TitlecaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2102 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2107 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 210b - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 210c - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 210d - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2110 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2111 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2112 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2115 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2119 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 211a - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 211b - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 211c - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 211d - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2124 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2126 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2128 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 212a - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 212b - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 212c - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 212d - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2130 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2131 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2133 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 213e - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 213f - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2145 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2c00 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2c01 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2c02 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2c03 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2c04 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2c05 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2c06 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2c07 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2c08 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2c09 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2c0a - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2c0b - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2c0c - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2c0d - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2c0e - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2c0f - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2c10 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2c11 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2c12 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2c13 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2c14 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2c15 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2c16 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2c17 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2c18 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2c19 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2c1a - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2c1b - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2c1c - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2c1d - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2c1e - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2c1f - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2c20 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2c21 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2c22 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2c23 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2c24 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2c25 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2c26 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2c27 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2c28 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2c29 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2c2a - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2c2b - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2c2c - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2c2d - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2c2e - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2c80 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2c82 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2c84 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2c86 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2c88 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2c8a - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2c8c - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2c8e - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2c90 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2c92 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2c94 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2c96 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2c98 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2c9a - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2c9c - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2c9e - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2ca0 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2ca2 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2ca4 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2ca6 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2ca8 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2caa - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2cac - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2cae - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2cb0 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2cb2 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2cb4 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2cb6 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2cb8 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2cba - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2cbc - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2cbe - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2cc0 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2cc2 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2cc4 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2cc6 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2cc8 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2cca - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2ccc - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2cce - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2cd0 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2cd2 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2cd4 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2cd6 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2cd8 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2cda - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2cdc - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2cde - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2ce0 - UppercaseLetter<BR>regex: False&nbsp;&nbsp;&nbsp; function: True&nbsp;&nbsp;&nbsp; char in hex: 2ce2 - UppercaseLetter<BR>TOTAL mismatches: 213</FONT></P></BLOCKQUOTE>
<P>I probably should have recognized the list since I have dealt with it before. But off the top of my head I didn't, and in the meantime Ryan over on the CLR team&nbsp; stepped in help explain what was going on:</P>
<BLOCKQUOTE>
<P><EM>This appear to be a bug in the Regex class. If IgnoreCase is present we will translate Lu and Lt to just Ll since we call Char.ToLower for every character in the input.&nbsp; You would likely know more about this than I do but I verified that Char.ToLower for one of the characters returns the same character presumably because there is no lower case version of the character.&nbsp; So the expression fails to match because the Unicode category for the character is still uppercase letter and we are trying to match Ll.</EM></P></BLOCKQUOTE>
<P>Ah, now it all came together.</P>
<P>Well, if you are running on Vista and have the <A href="http://archives.miloush.net/michkap/archive/2005/08/20/454071.html" mce_href="http://archives.miloush.net/michkap/archive/2005/08/20/454071.html"><STRONG>updated casing table</STRONG></A> then they will work. But otherwise, when you are not running on Vista, the casing table does not cover all of Unicode 5.0 even though the property table in&nbsp;.NET 2.0&nbsp;will.</P>
<P><EM>(if you run on .NET 1.1 then you will be missing even more characters since not all characters are identified, though in that case they will not be listed as missing in the script since neither function knows asbout them!)</EM></P>
<P>So if you are running on 2.0 of better, this Regex "optimization" is the cause of the bug.</P>
<P>Strictly speaking, there was no need to pass RegexOptions.IgnoreCase since <A href="http://msdn2.microsoft.com/library/system.char.isletter.aspx" mce_href="http://msdn2.microsoft.com/library/system.char.isletter.aspx">char.IsLetter</A>&nbsp;is going to pick both of them&nbsp;up anyway. So there is a workaround here -- don't pass flags that slow down the Regex and break its functioning anyway, and you can then freely use the Regex if you like (though it did still seem kinda slow to me, maybe there are some optimizations here.... :-)</P>
<P mce_keep="true">&nbsp;</P>
<P><FONT color=#ff0080><EM>This post brought to you by</EM> â°€ <EM>(<A href="http://www.fileformat.info/info/unicode/char/2c00" mce_href="http://www.fileformat.info/info/unicode/char/2c00">U+2c00</A>, a.k.a. GLAGOLITIC CAPITAL LETTER AZU)</EM></FONT></P>
<hr/><p><a id="2286381" href="#2286381">#</a> <strong>Michael S. Kaplan</strong> on 26 Apr 2007 9:20 AM:</p><div style="margin-left: 1em"><p>This bug actually indirectly shows which developers weren't running on Vista for their primary development machine. :-)</p>
</div>
<hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2008/07/25 <a href="http://archives.miloush.net/michkap/archive/2008/07/25/8771119.html">Let's save some time and call them all IRregular expression engines</a></p><p>2008/06/25 <a href="http://archives.miloush.net/michkap/archive/2008/06/25/8652525.html">Seeing the tears, my heart went out to her as I asked her "Why the Long S?"</a></p><p>2007/12/05 <a href="http://archives.miloush.net/michkap/archive/2007/12/05/6648893.html">No way to get that script info I was looking for earlier</a></p><p>2007/04/26 <a href="http://archives.miloush.net/michkap/archive/2007/04/26/2290760.html">'The 44' (*not* 'The 4400')</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2007/04/26/2290760.html" title="&#39;The 44&#39; (*not* &#39;The 4400&#39;)">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2007/04/26/2281645.html" title="Sprechen Sie IME?">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-04">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-04-26">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/04/26/2286153.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:38 GMT -->
</html>