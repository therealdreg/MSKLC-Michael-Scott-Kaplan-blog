<html>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/09/20/5008305.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:37 GMT -->
<head><meta charset="utf-8" /><meta name="viewport" content="width=device-width" /><title>A&P of Sort Keys, part 9 (aka Not always transitive, but punctual and punctuating)</title></head><body>
<h1>A&P of Sort Keys, part 9 (aka Not always transitive, but punctual and punctuating)</h1>
<p><em>by Michael S. Kaplan, published on 2007/09/20 03:31 -04:00, original URI: http://blogs.msdn.com/b/michkap/archive/2007/09/20/5008305.aspx</em></p>
<hr/> <!-- Archival Source: ProcessPostNew -->
<P>Previous posts in this series:</P>
<UL>
<LI>Part 0: <STRONG><A class="" href="http://archives.miloush.net/michkap/archive/2007/09/10/4847780.html" mce_href="http://archives.miloush.net/michkap/archive/2007/09/10/4847780.html">The empty string sorts the same in every language</A></STRONG> 
<LI>Part 1: <STRONG><A class="" href="http://archives.miloush.net/michkap/archive/2007/09/11/4861436.html" mce_href="http://archives.miloush.net/michkap/archive/2007/09/11/4861436.html">The law of the letter -- e.g. Latin &lt; Greek &lt; Cyrillic</A></STRONG> 
<LI>Part 2: <A class="" href="http://archives.miloush.net/michkap/archive/2007/09/12/4875560.html" mce_href="http://archives.miloush.net/michkap/archive/2007/09/12/4875560.html"><STRONG>The string that won? Didn't have a mark on him!</STRONG></A> 
<LI>Part 3: <A class="" href="http://archives.miloush.net/michkap/archive/2007/09/13/4889199.html" mce_href="http://archives.miloush.net/michkap/archive/2007/09/13/4889199.html"><STRONG>Should you let a string make it's case? If so, Y?</STRONG></A> 
<LI>Part 4: <A class="" href="http://archives.miloush.net/michkap/archive/2007/09/14/4905625.html" mce_href="http://archives.miloush.net/michkap/archive/2007/09/14/4905625.html"><STRONG>It isn't a race but let's make an EXCEPTION and cross the Finnish line</STRONG></A> 
<LI>Part 5: <A class="" href="http://archives.miloush.net/michkap/archive/2007/09/15/4924008.html" mce_href="http://archives.miloush.net/michkap/archive/2007/09/15/4924008.html"><STRONG>EXPANSIONing your horizons</STRONG></A> 
<LI>Part 6: <A class="" href="http://archives.miloush.net/michkap/archive/2007/09/16/4937196.html" mce_href="http://archives.miloush.net/michkap/archive/2007/09/16/4937196.html"><STRONG>Relax, be calm, and deCOMPRESS if you are feeling out of sorts</STRONG></A> 
<LI>Part 7: <A class="" href="http://archives.miloush.net/michkap/archive/2007/09/17/4950008.html" mce_href="http://archives.miloush.net/michkap/archive/2007/09/17/4950008.html"><STRONG>You're very thin now, but I can still recognize you</STRONG></A></LI>
<LI>Part 8: <A class="" href="http://archives.miloush.net/michkap/archive/2007/09/18/4971376.html" mce_href="http://archives.miloush.net/michkap/archive/2007/09/18/4971376.html"><STRONG>You can often think of ignoring weights as a form of ignorance</STRONG></A></LI></UL>
<P>Today's contribution to this series is one that has been the source of several misunderstandings.</P>
<P>It has also led to&nbsp;more than a few bug reports, though in truth most of the bugs were duplicates of the very same issue. :-)</P>
<P>It is about certain types of punctuation, and the impact of WORDSORT (as opposed to STRINGSORT) in linguistic comparisons.</P>
<P>I first talked about the feature in <A class="" href="http://archives.miloush.net/michkap/archive/2005/05/05/414845.html" mce_href="http://archives.miloush.net/michkap/archive/2005/05/05/414845.html"><STRONG>A few of the gotchas of CompareString</STRONG></A> and I will quote the relevant bit here:</P>
<BLOCKQUOTE>
<P><FONT face=Tahoma><STRONG>SORT_STRINGSORT</STRONG> - Treat punctuation the same as symbols. For example, a STRING sort treats co-op and co_op as strings that should sort together since the hyphen and the underscore are both treated as symbols. On the other hand, a WORD sort treats the hyphen and apostrophe differently, so that co-op and co_op would not sort together but co-op and coop would. The real documentation for this is built into the winnls.h header file:</FONT></P>
<BLOCKQUOTE dir=ltr>
<BLOCKQUOTE dir=ltr>
<P><FONT face="Consolas,Lucida Console,Courier New,Courier" size=1>//<BR>//&nbsp; Sorting Flags.<BR>//<BR>//&nbsp;&nbsp;&nbsp; WORD Sort:&nbsp;&nbsp;&nbsp; culturally correct sort<BR>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; hyphen and apostrophe are special cased<BR>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; example: "coop" and "co-op" will sort together in a list<BR>//<BR>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; co_op&nbsp;&nbsp;&nbsp;&nbsp; &lt;-------&nbsp; underscore (symbol)<BR>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; coat<BR>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; comb<BR>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; coop<BR>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; co-op&nbsp;&nbsp;&nbsp;&nbsp; &lt;-------&nbsp; hyphen (punctuation)<BR>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cork<BR>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; went<BR>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; were<BR>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; we're&nbsp;&nbsp;&nbsp;&nbsp; &lt;-------&nbsp; apostrophe (punctuation)<BR>//<BR>//<BR>//&nbsp;&nbsp;&nbsp; STRING Sort:&nbsp; hyphen and apostrophe will sort with all other symbols<BR>//<BR>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; co-op&nbsp;&nbsp;&nbsp;&nbsp; &lt;-------&nbsp; hyphen (punctuation)<BR>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; co_op&nbsp;&nbsp;&nbsp;&nbsp; &lt;-------&nbsp; underscore (symbol)<BR>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; coat<BR>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; comb<BR>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; coop<BR>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cork<BR>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; we're&nbsp;&nbsp;&nbsp;&nbsp; &lt;-------&nbsp; apostrophe (punctuation)<BR>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; went<BR>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; were<BR>//</FONT><FONT face=Tahoma></P></BLOCKQUOTE></BLOCKQUOTE></FONT></BLOCKQUOTE>
<P mce_keep="true">The reasons for this feature are fairly clear -- in many contexts, the default word sorting is more useful and much more intuitive.</P>
<P mce_keep="true">Of course among the reasons that it is not always expected:</P>
<UL>
<LI>
<DIV mce_keep="true">When <STRONG>-</STRONG> (U+002d, a.k.a. HYPHEN-MINUS) is being less of a hyphen and more of a minus, the results are not only unintuitive, they also cause interesting problems such as I discussed in <STRONG><A class="" href="http://archives.miloush.net/michkap/archive/2006/11/16/1086283.html" mce_href="http://archives.miloush.net/michkap/archive/2006/11/16/1086283.html">The problem of string comparisons, WORD sorts, and the minus that is treated like the hyphen</A></STRONG>;</DIV></LI>
<LI>
<DIV mce_keep="true">Sometimes, for example in situations like the one discussed in <A class="" href="http://archives.miloush.net/michkap/archive/2006/05/04/589656.html" mce_href="http://archives.miloush.net/michkap/archive/2006/05/04/589656.html"><STRONG>Sort the words, sort the strings</STRONG></A>, even for nominal hyphens the behavior can be less than intuitive (mainly when they are a part of symbolic identifiers);</DIV></LI>
<LI>
<DIV mce_keep="true">When <STRONG>'</STRONG> (U+0027, a.k.a. APOSTROPHE) is used as a variation of " (U+0022, a.k.a. QUOTATION MARK) then the fact that the behavior is intuitive for contraction usage is sullid by how <STRONG>un</STRONG>intuitive it is for other uses.</DIV></LI></UL>
<P mce_keep="true">The most recent report of the first issue (by far the most common) was just a week ago, and it led to ond of the developers over in MSN concluding that:</P>
<BLOCKQUOTE>
<P mce_keep="true"><EM>It just shows how evil String.Compare is (for being completely counter-intuitive.)</EM></P></BLOCKQUOTE>
<P mce_keep="true">Hard to argue with that!</P>
<P mce_keep="true">It <EM>almost</EM> makes one want to do something smarter in the function to try and detect the two cases and handle them differently -- perhaps not too hard since the actual cases are so very different?</P>
<P mce_keep="true">Plus it would be cool to add a SORT_SMARTSORT constant here. :-)</P>
<P mce_keep="true">Let's take a step back and see what the sort keys say. </P>
<P mce_keep="true">Remmeber that sort keys are only run on a single string and are thus not subject to the "a &lt; b&nbsp;but b &lt; a" type bugs that can lead to real problems. Although as a general principle any time transitivity is not there or when behavior is different between <A class="" href="http://msdn2.microsoft.com/library/ms647476.aspx" mce_href="http://msdn2.microsoft.com/library/ms647476.aspx">CompareString</A>/<A class="" href="http://msdn2.microsoft.com/library/ms647477.aspx" mce_href="http://msdn2.microsoft.com/library/ms647477.aspx">CompareStringEx</A> and <A class="" href="http://msdn2.microsoft.com/library/ms776290.aspx" mce_href="http://msdn2.microsoft.com/library/ms776290.aspx">LCMapString</A>/<A class="" href="http://msdn2.microsoft.com/library/ms776387.aspx" mce_href="http://msdn2.microsoft.com/library/ms776387.aspx">LCMapStringEx</A> with LCMAP_SORTKEY deciding which one is wrong can vary, in practice it is usually not the sort keys -- thus they make the best baseline for us, functionally<FONT size=1><SUP>1</SUP></FONT>.</P>
<BLOCKQUOTE>
<P mce_keep="true"><B><FONT face="consolas,lucida console,courier new,courier">(WS) -0.67:-0.33:0.33&nbsp;&nbsp;&nbsp; <FONT color=#009900>0c 03 07 33 0c 7d 0c 90 07 37 0c 03 07 33 0c 46 0c 46 07 37 0c 03 07 33 0c 46 0c 46</FONT> 01 01 01 01 <FONT color=#ff00ff>80</FONT> <FONT color=#ff00ff>07 06 82 80 1b 06 82</FONT> 00<BR>(WS) -0.67:0.33:-0.33&nbsp;&nbsp;&nbsp; <FONT color=#009900>0c 03 07 33 0c 7d 0c 90 07 37 0c 03 07 33 0c 46 0c 46 07 37 0c 03 07 33 0c 46 0c 46</FONT> 01 01 01 01 <FONT color=#ff00ff>80 07 06 82 80 2f 06 82</FONT> 00<BR>(WS) 0.67:-0.33:0.33&nbsp;&nbsp;&nbsp;&nbsp; <FONT color=#009900>0c 03 07 33 0c 7d 0c 90 07 37 0c 03 07 33 0c 46 0c 46 07 37 0c 03 07 33 0c 46 0c 46</FONT> 01 01 01 <FONT color=#ff00ff><FONT color=#000000>01</FONT> 80 1b 06 82</FONT> 00<BR><BR>(SS) -0.67:-0.33:0.33&nbsp;&nbsp;&nbsp; <FONT color=#009900>06 82 0c 03 07 33 0c 7d 0c 90 07 37 06 82 0c 03 07 33 0c 46 0c 46 07 37 0c 03 07 33 0c 46 0c 46</FONT> 01 01 01 01 00<BR>(SS) -0.67:0.33:-0.33&nbsp;&nbsp;&nbsp; <FONT color=#009900>06 82 0c 03 07 33 0c 7d 0c 90 07 37 0c 03 07 33 0c 46 0c 46 07 37 06 82 0c 03 07 33 0c 46 0c 46</FONT> 01 01 01 01 00<BR>(SS) 0.67:-0.33:0.33&nbsp;&nbsp;&nbsp;&nbsp; <FONT color=#009900>0c 03 07 33 0c 7d 0c 90 07 37 06 82 0c 03 07 33 0c 46 0c 46 07 37 0c 03 07 33 0c 46 0c 46 </FONT><FONT color=#000000>01 01 01 01 00</FONT></FONT></B></P></BLOCKQUOTE>
<P mce_keep="true">Clearly, there is a specific preferred ordering for the sort keys based on the earlier hyphen trumping the later one, so in choosing which <A class="" href="http://msdn2.microsoft.com/library/ms647476.aspx" mce_href="http://msdn2.microsoft.com/library/ms647476.aspx">CompareString</A>/<A class="" href="http://msdn2.microsoft.com/library/ms647477.aspx" mce_href="http://msdn2.microsoft.com/library/ms647477.aspx">CompareStringEx</A>&nbsp;to prefer, one has a way to go. This is thankfully much less controversial of a decision than when one has to choose between <A class="" href="http://msdn2.microsoft.com/library/ms647476.aspx" mce_href="http://msdn2.microsoft.com/library/ms647476.aspx">CompareString</A>/<A class="" href="http://msdn2.microsoft.com/library/ms647477.aspx" mce_href="http://msdn2.microsoft.com/library/ms647477.aspx">CompareStringEx</A> and <A class="" href="http://msdn2.microsoft.com/library/ms776290.aspx" mce_href="http://msdn2.microsoft.com/library/ms776290.aspx">LCMapString</A>/<A class="" href="http://msdn2.microsoft.com/library/ms776387.aspx" mce_href="http://msdn2.microsoft.com/library/ms776387.aspx">LCMapStringEx</A> with LCMAP_SORTKEY, since in those cases clients like SQL Server are already contending with index corruption&nbsp;due to&nbsp;the "not so very transitive" results, so as long as one is correct and the other is treated as a bug, they can fix it without waiting for new collations, etc.</P>
<P mce_keep="true">At this point, many people thinking about the fillers one sees in the DW and CW values will wonder exactly how these punctuation weights are being defined. I'll give you a very big hint:</P>
<BLOCKQUOTE><B><FONT face="consolas,lucida console,courier new,courier">
<P mce_keep="true">-012345&nbsp;&nbsp;&nbsp;&nbsp; <FONT color=#009900>0c 03 0c 21 0c 33 0c 46 0c 58 0c 6a</FONT> 01 01 01 01 <FONT color=#ff00ff>80 07 06 82</FONT> 00<BR>0-12345&nbsp;&nbsp;&nbsp;&nbsp; <FONT color=#009900>0c 03 0c 21 0c 33 0c 46 0c 58 0c 6a</FONT> 01 01 01 01 <FONT color=#ff00ff>80 0b 06 82</FONT> 00<BR>012-345&nbsp;&nbsp;&nbsp;&nbsp; <FONT color=#009900>0c 03 0c 21 0c 33 0c 46 0c 58 0c 6a</FONT> 01 01 01 01 <FONT color=#ff00ff>80 13 06 82</FONT> 00<BR>0123-45&nbsp;&nbsp;&nbsp;&nbsp; <FONT color=#009900>0c 03 0c 21 0c 33 0c 46 0c 58 0c 6a</FONT> 01 01 01 01 <FONT color=#ff00ff>80 17 06 82</FONT> 00<BR>01234-5&nbsp;&nbsp;&nbsp;&nbsp; <FONT color=#009900>0c 03 0c 21 0c 33 0c 46 0c 58 0c 6a</FONT> 01 01 01 01 <FONT color=#ff00ff>80 1b 06 82</FONT> 00<BR>012345-&nbsp;&nbsp;&nbsp;&nbsp; <FONT color=#009900>0c 03 0c 21 0c 33 0c 46 0c 58 0c 6a</FONT> 01 01 01 01 <FONT color=#ff00ff>80 1f 06 82</FONT> 00</P></FONT></B></BLOCKQUOTE>
<P mce_keep="true">See what is going on? It still is acting as a filler -- it is just compressing it some. This is much less feasible to do for DW and CW portions of the weight given the additive nature of the values in them, but at least you know punctuation does not waste too much space in sort keys!</P>
<P mce_keep="true">There are other characters that have this special weight value; to find them all, you could grab the sort key of each character from 0x0000 to 0xFFFF when the SORT_STRINGSORT flag is included -- these "special punctuation" values all have a first byte value of <STRONG>06</STRONG>. </P>
<P mce_keep="true">In Vista, these values (in weight order, with their other weights present as well) are:</P>
<BLOCKQUOTE>
<P mce_keep="true"><FONT face="courier new,courier">CODEPOINT&nbsp;SM&nbsp;&nbsp; AW&nbsp;&nbsp; DW&nbsp;&nbsp; CW&nbsp;&nbsp; COMMENT<BR>0x0001&nbsp;&nbsp;&nbsp; 6&nbsp;&nbsp;&nbsp; 3&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp; ;Start Of Heading<BR>0x0002&nbsp;&nbsp;&nbsp; 6&nbsp;&nbsp;&nbsp; 4&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp; ;Start Of Text<BR>0x0003&nbsp;&nbsp;&nbsp; 6&nbsp;&nbsp;&nbsp; 5&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp; ;End Of Text<BR>0x0004&nbsp;&nbsp;&nbsp; 6&nbsp;&nbsp;&nbsp; 6&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp; ;End Of Transmission<BR>0x0005&nbsp;&nbsp;&nbsp; 6&nbsp;&nbsp;&nbsp; 7&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp; ;Enquiry<BR>0x0006&nbsp;&nbsp;&nbsp; 6&nbsp;&nbsp;&nbsp; 8&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp; ;Acknowledge<BR>0x0007&nbsp;&nbsp;&nbsp; 6&nbsp;&nbsp;&nbsp; 9&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp; ;Bell<BR>0x0008&nbsp;&nbsp;&nbsp; 6&nbsp;&nbsp;&nbsp; 10&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp; ;Backspace<BR>0x000e&nbsp;&nbsp;&nbsp; 6&nbsp;&nbsp;&nbsp; 11&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp; ;Shift Out<BR>0x000f&nbsp;&nbsp;&nbsp; 6&nbsp;&nbsp;&nbsp; 12&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp; ;Shift In<BR>0x0010&nbsp;&nbsp;&nbsp; 6&nbsp;&nbsp;&nbsp; 13&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp; ;Data Link Escape<BR>0x0011&nbsp;&nbsp;&nbsp; 6&nbsp;&nbsp;&nbsp; 14&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp; ;Device Control One<BR>0x0012&nbsp;&nbsp;&nbsp; 6&nbsp;&nbsp;&nbsp; 15&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp; ;Device Control Two<BR>0x0013&nbsp;&nbsp;&nbsp; 6&nbsp;&nbsp;&nbsp; 16&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp; ;Device Control Three<BR>0x0014&nbsp;&nbsp;&nbsp; 6&nbsp;&nbsp;&nbsp; 17&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp; ;Device Control Four<BR>0x0015&nbsp;&nbsp;&nbsp; 6&nbsp;&nbsp;&nbsp; 18&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp; ;Negative Acknowledge<BR>0x0016&nbsp;&nbsp;&nbsp; 6&nbsp;&nbsp;&nbsp; 19&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp; ;Synchronous Idle<BR>0x0017&nbsp;&nbsp;&nbsp; 6&nbsp;&nbsp;&nbsp; 20&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp; ;End Of Transmission Block<BR>0x0018&nbsp;&nbsp;&nbsp; 6&nbsp;&nbsp;&nbsp; 21&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp; ;Cancel<BR>0x0019&nbsp;&nbsp;&nbsp; 6&nbsp;&nbsp;&nbsp; 22&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp; ;End Of Medium<BR>0x001a&nbsp;&nbsp;&nbsp; 6&nbsp;&nbsp;&nbsp; 23&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp; ;Substitute<BR>0x001b&nbsp;&nbsp;&nbsp; 6&nbsp;&nbsp;&nbsp; 24&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp; ;Escape<BR>0x001c&nbsp;&nbsp;&nbsp; 6&nbsp;&nbsp;&nbsp; 25&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp; ;File Separator<BR>0x001d&nbsp;&nbsp;&nbsp; 6&nbsp;&nbsp;&nbsp; 26&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp; ;Group Separator<BR>0x001e&nbsp;&nbsp;&nbsp; 6&nbsp;&nbsp;&nbsp; 27&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp; ;Record Separator<BR>0x001f&nbsp;&nbsp;&nbsp; 6&nbsp;&nbsp;&nbsp; 28&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp; ;Unit Separator<BR>0x007f&nbsp;&nbsp;&nbsp; 6&nbsp;&nbsp;&nbsp; 29&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp; ;Delete<BR>0x0027&nbsp;&nbsp;&nbsp; 6&nbsp;&nbsp;&nbsp; 128&nbsp; 2&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp; ;Apostrophe-Quote<BR>0xff07&nbsp;&nbsp;&nbsp; 6&nbsp;&nbsp;&nbsp; 128&nbsp; 2&nbsp;&nbsp;&nbsp; 3&nbsp;&nbsp;&nbsp; ;Fullwidth Apostrophe-Quote<BR>0x07F4&nbsp;&nbsp;&nbsp; 6&nbsp;&nbsp;&nbsp; 129&nbsp; 2&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp; ;NKO HIGH TONE APOSTROPHE<BR>0x07F5&nbsp;&nbsp;&nbsp; 6&nbsp;&nbsp;&nbsp; 129 &nbsp;20&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp; ;NKO LOW TONE APOSTROPHE<BR>0x002d&nbsp;&nbsp;&nbsp; 6&nbsp;&nbsp;&nbsp; 130&nbsp; 2&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp; ;Hyphen-Minus<BR>0xff0d&nbsp;&nbsp;&nbsp; 6&nbsp;&nbsp;&nbsp; 130&nbsp; 2&nbsp;&nbsp;&nbsp; 3&nbsp;&nbsp;&nbsp; ;Fullwidth Hyphen-Minus<BR>0xfe63&nbsp;&nbsp;&nbsp; 6&nbsp;&nbsp;&nbsp; 130&nbsp; 2&nbsp;&nbsp;&nbsp; 8&nbsp;&nbsp;&nbsp; ;Small Hyphen-Minus<BR>0x2212&nbsp;&nbsp;&nbsp; 6&nbsp;&nbsp;&nbsp; 131&nbsp; 2&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp; ;Minus Sign<BR>0x208b&nbsp;&nbsp;&nbsp; 6&nbsp;&nbsp;&nbsp; 131&nbsp; 2&nbsp;&nbsp;&nbsp; 4&nbsp;&nbsp;&nbsp; ;Subscript Hyphen-Minus<BR>0x207b&nbsp;&nbsp;&nbsp; 6&nbsp;&nbsp;&nbsp; 131&nbsp; 2&nbsp;&nbsp;&nbsp; 14&nbsp;&nbsp;&nbsp; ;Superscript Hyphen-Minus<BR>0x2010&nbsp;&nbsp;&nbsp; 6&nbsp;&nbsp;&nbsp; 132&nbsp; 2&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp; ;Hyphen<BR>0x058a&nbsp;&nbsp;&nbsp; 6&nbsp;&nbsp;&nbsp; 132&nbsp; 21&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp; ;Armenian Hyphen<BR>0x2011&nbsp;&nbsp;&nbsp; 6&nbsp;&nbsp;&nbsp; 133&nbsp; 2&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp; ;Non-Breaking Hyphen<BR>0x2027&nbsp;&nbsp;&nbsp; 6&nbsp;&nbsp;&nbsp; 134&nbsp; 2&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp; ;Hyphenation Point<BR>0x2043&nbsp;&nbsp;&nbsp; 6&nbsp;&nbsp;&nbsp; 135&nbsp; 2&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp; ;Hyphen Bullet<BR>0x2012&nbsp;&nbsp;&nbsp; 6&nbsp;&nbsp;&nbsp; 136&nbsp; 2&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp; ;Figure Dash<BR>0x2013&nbsp;&nbsp;&nbsp; 6&nbsp;&nbsp;&nbsp; 137&nbsp; 2&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp; ;En Dash<BR>0xfe32&nbsp;&nbsp;&nbsp; 6&nbsp;&nbsp;&nbsp; 144&nbsp; 2&nbsp;&nbsp;&nbsp; 12&nbsp;&nbsp;&nbsp; ;Glyph For Vertical En Dash<BR>0x2014&nbsp;&nbsp;&nbsp; 6&nbsp;&nbsp;&nbsp; 144&nbsp; 21&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp; ;Em Dash<BR>0xfe58&nbsp;&nbsp;&nbsp; 6&nbsp;&nbsp;&nbsp; 144&nbsp; 21&nbsp;&nbsp;&nbsp;8&nbsp;&nbsp;&nbsp; ;Small Em Dash<BR>0xfe31&nbsp;&nbsp;&nbsp; 6&nbsp;&nbsp;&nbsp; 144&nbsp; 21&nbsp;&nbsp;&nbsp;12&nbsp;&nbsp;&nbsp; ;Glyph For Vertical Em Dash<BR>0x2015&nbsp;&nbsp;&nbsp; 6&nbsp;&nbsp;&nbsp; 146&nbsp; 2&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp; ;Quotation Dash<BR>0x301c&nbsp;&nbsp;&nbsp; 6&nbsp;&nbsp;&nbsp; 147&nbsp; 2&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp; ;Wave Dash<BR>0x3030&nbsp;&nbsp;&nbsp; 6&nbsp;&nbsp;&nbsp; 148&nbsp; 2&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp; ;Wavy Dash</FONT></P></BLOCKQUOTE>
<P mce_keep="true">The control characters are there for compatibility with prior versions and are used by some&nbsp;very low level pieces of Windows as sentinels (when we triedd to change the values we qwuickly made the system unbootable!).</P>
<P mce_keep="true">The only other thing to note is that <STRONG>08</STRONG> case weight bug I mentioned in <STRONG><A class="" href="http://archives.miloush.net/michkap/archive/2007/09/13/4889199.html" mce_href="http://archives.miloush.net/michkap/archive/2007/09/13/4889199.html">Part 3</A></STRONG> is here too for a few characters. Did anyone from the NLS test team put that bug in yet? :-)</P>
<P mce_keep="true">As a bonus, can anyone explain why it doesn't matter in the default case, and under what combination of circumstances it would matter? I'll put the answer in a comment eventually if no one else figures it out....</P>
<P mce_keep="true">&nbsp;</P>
<P mce_keep="true"><FONT size=1>1 - The de facto decision to consider sort key results&nbsp;to be definitive is quite ironic given that SQL Server<SUP>2</SUP> uses </FONT><A class="" href="http://msdn2.microsoft.com/library/ms647476.aspx" mce_href="http://msdn2.microsoft.com/library/ms647476.aspx"><FONT size=1>CompareString</FONT></A><FONT size=1>&nbsp;to build its sort keys.<BR>2 - It is fascinating though perhaps not unexpected to note that the single biggest reporter of </FONT><A class="" href="http://msdn2.microsoft.com/library/ms647476.aspx" mce_href="http://msdn2.microsoft.com/library/ms647476.aspx"><FONT size=1>CompareString</FONT></A><FONT size=1>&nbsp;anomalies is in fact SQL Server.</FONT></P>
<P mce_keep="true">&nbsp;</P>
<P mce_keep="true"><FONT color=#ff00ff><EM>This post brought to you by</EM> <FONT size=5>9</FONT> </FONT><EM><FONT color=#ff00ff>(</FONT><A class="" href="http://www.fileformat.info/info/unicode/char/0039" mce_href="http://www.fileformat.info/info/unicode/char/0039">U+0039</A><FONT color=#ff00ff>, a.k.a. DIGIT NINE)</FONT></EM></P>
<hr/><div style="margin-left: 1em"><em>no comments</em></div><hr/><p><em>referenced by</em></p><div style="margin-left: 1em"><p>2010/09/07 <a href="http://archives.miloush.net/michkap/archive/2010/09/07/10058112.html">Refusing to ignore some particular character's width isn't [always] an act of discriminationâ€¦</a></p><p>2010/06/11 <a href="http://archives.miloush.net/michkap/archive/2010/06/11/10022741.html">Call it Reversible Error, aka Yes it has no weight; it was supposed to have no weight!</a></p><p>2010/06/10 <a href="http://archives.miloush.net/michkap/archive/2010/06/10/10021417.html">WORD SORT...Why'd it have to be...WORD SORT?</a></p><p>2008/08/21 <a href="http://archives.miloush.net/michkap/archive/2008/08/21/8883467.html">A&P of Sort Keys, part 14: The Hangul is really getting OLD</a></p><p>2008/01/14 <a href="http://archives.miloush.net/michkap/archive/2008/01/14/7102809.html">On reversing the irreversible (The Set-Up)</a></p><p>2007/10/30 <a href="http://archives.miloush.net/michkap/archive/2007/10/30/5774614.html">EXPECTED is in the eye of the [non-expecting type of ]expectant</a></p><p>2007/10/09 <a href="http://archives.miloush.net/michkap/archive/2007/10/09/5375754.html">A&P of Sort Keys, part 13 (About the function that is too lazy to get it right every time)</a></p><p>2007/10/08 <a href="http://archives.miloush.net/michkap/archive/2007/10/08/5270854.html">A&P of Sort Keys, part 12 (aka Han sorts first!)</a></p><p>2007/09/24 <a href="http://archives.miloush.net/michkap/archive/2007/09/24/5085893.html">A&P of Sort Keys, part 11 (aka It's not like ideographic sorts were developed idiopathically)</a></p><p>2007/09/21 <a href="http://archives.miloush.net/michkap/archive/2007/09/21/5027338.html">A&P of Sort Keys, part 10 (aka I've kana wanted to start talking about Japanese)</a></p></div><p><em>go to <a id="newer" href="http://archives.miloush.net/michkap/archive/2007/09/21/5025885.html" title="If you had gotten there first, you might have staked your claim too!">newer</a> or <a id="older" href="http://archives.miloush.net/michkap/archive/2007/09/20/4969758.html" title="Avoiding entitlement (aka Don&#39;t bother, it&#39;s okay)">older</a> post, or back to <a href="http://archives.miloush.net/michkap/archive/index.html">index</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-09">month</a> or <a href="http://archives.miloush.net/michkap/archive/index.html#2007-09-20">day</a></em></p></body>
<!-- Mirrored from archives.miloush.net/michkap/archive/2007/09/20/5008305.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 May 2017 00:42:37 GMT -->
</html>